# Лабораторная работа №3: "Незнайка на Луне"

## Описание проекта

Объектно-ориентированная модель по отрывку из произведения Н. Носова "Незнайка на Луне". Программа эмулирует процесс создания ракеты с двойной системой управления и вариативный сценарий поиска лунита.

---

## Структура проекта

```
lab_3_lisa/
├── Main.java                      # Точка входа, сборка сценария
├── text.md                        # Исходный текст для эмуляции
├── enums/                         # Перечисления
│   ├── Gender.java               # Пол персонажа
│   ├── HairColor.java            # Цвет волос
│   └── Location.java             # Локации
├── exceptions/                    # Исключения
│   ├── InsufficientResourcesException.java  # Checked
│   └── DeliveryException.java               # Unchecked
├── interfaces/                    # Интерфейсы
│   └── Transportable.java       # Для транспортировки чертежей
└── models/                        # Основные классы
    ├── MaterialInfo.java         # Record: свойства материалов
    ├── PhysicalObject.java       # Абстрактный класс: физические объекты
    ├── Human.java                # Абстрактный класс: персонажи
    ├── Thought.java              # Мысли/идеи персонажей
    ├── Action.java               # Действия персонажей
    ├── Event.java                # События в мире
    ├── Znaika.java               # Знайка (учёный)
    ├── Fuchsia.java              # Фуксия (конструктор)
    ├── Seledochka.java           # Селедочка (конструктор)
    ├── Rocket.java               # Ракета
    ├── Lunit.java                # Лунит (редкий минерал)
    └── Blueprint.java            # Чертёж
```

---

## За что отвечает каждый класс

### Абстрактные классы

#### `Human` - Базовый класс для всех персонажей
**Зачем нужен:** Обеспечивает универсальное поведение для ЛЮБЫХ персонажей, независимо от сюжета.

**Ключевые методы (универсальные):**
- `think(String content)` - подумать → создаёт Thought
- `propose(Thought thought)` - предложить мысль другим
- `perform(String actionName, String description)` - выполнить действие → создаёт Action
- `moveTo(Location destination)` - переместиться

**Важно:** Персонажи **НЕ содержат** plot-specific методов (типа `proposeDualControl()`). Это позволяет использовать те же классы в разных сюжетах.

---

#### `PhysicalObject` - Базовый класс для физических объектов
**Зачем нужен:** Общая база для всех материальных объектов (ракета, лунит, чертёжи).

**Поля:**
- `name` - название
- `purpose` - предназначение
- `material` - материал (MaterialInfo)

---

### Классы для управления поведением

#### `Thought` - Мысли и идеи персонажей
**Зачем нужен:** Хранит и структурирует мысли персонажей.

**Поля:**
- `content` - текст мысли
- `author` - кто подумал (Human)
- `category` - категория (идея, размышление, надежда)
- `isShared` - предложена ли другим

**Методы:**
- `markAsShared()` - отметить как предложенную

**Пример:** Используется чтобы Знайка мог предложить идею двойного управления, а затем она была "поделена" с другими.

---

#### `Action` - Действия персонажей
**Зачем нужен:** Представляет любое действие персонажа с возможностью цепочки целей (fluent interface).

**Поля:**
- `performer` - кто выполняет (Human)
- `targets` - список объектов действия
- `isCompleted` - выполнено ли

**Методы:**
- `withTarget(Object target)` - добавить цель (можно вызывать много раз)
- `execute()` - выполнить действие

**Пример использования:**
```java
znaika.perform("координация", "координирует работу инженеров")
    .withTarget("инженер Винтик")
    .withTarget("инженер Шпунтик")
    .execute();
```

**Важно:** Один и тот же метод `perform()` работает для ЛЮБЫХ действий - создания эскизов, перемещения, координации. Это реализует полиморфизм.

---

#### `Event` - События в мире
**Зачем нужен:** Представляет важные события, происходящие независимо от персонажей.

**Поля:**
- `name` - название события
- `description` - описание
- `type` - тип (enum: DISCOVERY, INTERACTION, STATE_CHANGE, CREATION)
- `participants` - участники

**Методы:**
- `withParticipant(Object participant)` - добавить участника
- `occur()` - событие произошло

**Пример:** Используется для события "Обнаружен лунит" при поисковой экспедиции.

---

### Персонажи

#### `Znaika`, `Fuchsia`, `Seledochka`
**Зачем нужны:** Конкретные персонажи книги.

**Особенность:** **НЕ имеют дополнительных методов**. Только конструктор и `toString()` с ролью.

**Принцип:** Всё их поведение задаётся через универсальные методы `Human`. Это делает классы расширяемыми - можно использовать в ЛЮБЫХ сюжетах.

---

### Предметы

#### `Rocket` - Ракета
**Зачем нужен:** Космический корабль для полёта на Луну.

**Enum `ControlSystem` внутри:**
- `GRAVITY` - управление в условиях тяжести
- `ZERO_GRAVITY` - управление в невесомости
- `DUAL` - двойное управление (и то, и другое)

**Поля:**
- `controlSystem` - установленный тип управления
- `blueprints` - список чертежей (ArrayList)
- `lunitDevice` - прибор невесомости (если есть)

**Методы:**
- `setControlSystem(ControlSystem)` - установить тип управления
- `addBlueprint(Blueprint)` - добавить чертёж
- `setLunitDevice(Lunit.WeightlessnessDevice)` - установить прибор
- `launch()` - запустить (бросает InsufficientResourcesException если нет лунита)
- `launchStandardMode()` - запуск в штатном режиме

**Важно:** Запуск возможен только если есть чертежи. Это реализовано через `IllegalStateException`.

---

#### `Lunit` - Лунит
**Зачем нужен:** Редкий лунный минерал, позволяющий создать прибор невесомости.

**Поля:**
- `isDiscovered` - обнаружен ли в пещере
- `discoveryLocation` - где найден

**Методы:**
- `discover(Location location)` - обнаружить залежи
- `createDevice()` - создать прибор невесомости

**Внутренний класс `WeightlessnessDevice`:**
- `activate()` - активировать (отключает гравитацию)
- `deactivate()` - деактивировать

**Важность:** Без лунита ракета не может лететь в "полном" режиме, только в штатном.

---

#### `Blueprint` - Чертёж
**Зачем нужен:** Чертёж узла ракеты для изготовления на заводе.

**Поля:**
- `factoryName` - назначенный завод
- `isApproved` - утверждён ли
- `isDelivered` - доставлен ли

**Методы:**
- `approve()` - утвердить перед отправкой
- `setFactory(String)` - назначить завод
- `transport(Blueprint)` - транспортировать на завод (реализует Transportable)

**Особенность:** Нельзя транспортировать неутверждённый чертёж (бросает DeliveryException).

---

### Вспомогательные классы

#### `MaterialInfo` (record)
**Зачем нужен:** Описывает свойства материала.

**Компоненты:**
- `name` - название (например, "Лунит")
- `weight` - вес в кг
- `isRare` - редкий ли
- `description` - описание

**Пример:** `new MaterialInfo("Лунит", 1.5, true, "антигравитационный минерал")`

---

### Enum (перечисления)

#### `Gender`
- `MALE` - мужской
- `FEMALE` - женский

#### `HairColor`
- `BLACK`, `CHESTNUT`, `BLONDE`, `LIGHT`, `GRAY`, `RED`

#### `Location`
- `FLOWER_CITY` - Цветочный город
- `SCIENTIFIC_TOWN` - Научный городок
- `MOON` - Луна
- `MOON_CAVE` - Пещера на Луне
- `ROCKET` - На борту ракеты
- `FACTORY` - Завод

---

### Исключения

#### `InsufficientResourcesException` (checked)
**Зачем нужен:** Бросается когда недостаточно ресурсов.

**Когда используется:** В `Rocket.launch()` если нет лунита и прибора невесомости.

**Пример:**
```java
if (!hasLunit) {
    throw new InsufficientResourcesException("Лунит не найден");
}
```

---

#### `DeliveryException` (unchecked)
**Зачем нужен:** Ошибка при транспортировке чертежей.

**Когда используется:** В `Blueprint.transport()` если чертёж не утверждён.

---

#### `IllegalStateException` (unchecked, кастомный getMessage())
**Зачем нужен:** Попытка запуска без чертежей.

**Где переопределён getMessage():** В `Rocket.launch()` для более информативного сообщения.

---

### Интерфейсы

#### `Transportable`
**Зачем нужен:** Для объектов, которые можно транспортировать.

**Метод:**
- `transport(Blueprint blueprint)` - транспортировать чертёж

**Реализует:** `Blueprint`

---

## Как работает программа

### Сценарий (вариативный через Random)

1. **Создание персонажей** - Знайка, Фуксия, Селедочка
2. **Идея Знайки** - через `think()` предлагает двойное управление
3. **Создание эскизов** - Фуксия и Селедочка через `perform()` создают эскизы
4. **Отправка в Научный городок** - через `moveTo()`
5. **Работа инженеров** - Знайка через `perform()` координирует
6. **Чертежи** - создаются, утверждаются, добавляются к ракете
7. **Поиск лунита** - случайный выбор (50%):
   - **Найден:** создаётся прибор невесомости → двойное управление → запуск
   - **Не найден:** запуск в штатном режиме → управление только для тяжести

---

## Принципы SOLID в проекте

### Single Responsibility
- `Human` - управление персонажем
- `Thought` - хранение мыслей
- `Action` - выполнение действий
- `Rocket` - управление ракетой
- Каждый класс делает одну вещь

### Open/Closed
- Персонажи **НЕ зависят** от конкретного сюжета
- Можно создать новый сценарий без изменения классов
- Пример: `Demo.java` показывает тот же код в другом сюжете (туризм)

### Liskov Substitution
- `Znaika`, `Fuchsia`, `Seledochka` могут заменять `Human`
- Любой персонаж работает с любыми методами базового класса

### Interface Segregation
- `Transportable` - фокусированный интерфейс для транспортировки
- Только нужные методы, ничего лишнего

### Dependency Inversion
- Зависимость от абстракций (`Human`, `PhysicalObject`)
- А не от конкретных реализаций (`Znaika`, `Rocket`)

---

## Вариативность и Random

Программа использует `Random.nextBoolean()` для случайного выбора сценария:

```java
boolean lunitFound = random.nextBoolean();  // 50%

if (lunitFound) {
    // Сценарий 1: с лунитом
} else {
    // Сценарий 2: без лунита
}
```

Это обеспечивает вариативность при каждом запуске.

---

## Компиляция и запуск

```bash
cd Java/lab_3_lisa

# Компиляция
javac -encoding UTF-8 -cp . *.java enums/*.java exceptions/*.java interfaces/*.java models/*.java

# Запуск
java -cp . Main
```
